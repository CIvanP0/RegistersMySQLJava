package Vista;
import com.itextpdf.text.BaseColor;
import com.itextpdf.text.Chunk;
import com.itextpdf.text.Document;
import com.itextpdf.text.Element;
import com.itextpdf.text.Font;
import com.itextpdf.text.Image;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.pdf.PdfPTable;
import com.itextpdf.text.pdf.PdfWriter;
import java.io.File;
import java.io.FileOutputStream;
import java.sql.Connection;
import javax.swing.JOptionPane;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.Date;
/**
 *
 * @author Usuario
 */
public class subMenuProducto extends javax.swing.JInternalFrame {

    public static final String URL = "jdbc:mysql://localhost:3306/ciguena";
    public static final String USERNAME = "root";
    public static final String PASSWORD = "24682468";
    
    PreparedStatement ps;
    ResultSet rs;

     public static Connection getConnection(){
     
        Connection con = null;
        
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            con = DriverManager.getConnection(URL, USERNAME, PASSWORD);
            //JOptionPane.showMessageDialog(null, "Conexion exitosa");
        }catch(Exception e){
            System.out.println(e);
        }return con;
    }
     
     private void limpiarCajas(){
         
         txtCodigo.setText(null);
         txtNombre.setText(null);
         txtMarca.setText(null);
         txtPrecio.setText(null);
         txtDisponibilidad.setText(null);
         txtEstado.setText(null);
         txtProveedor.setText(null);
         
     }
     
     private void pdf(){
        try {
        FileOutputStream archivo;
        File file = new File("src/pdf/Prueba3");
        archivo = new FileOutputStream(file);
        Document doc = new Document();
        PdfWriter.getInstance(doc, archivo);
        doc.open();
        Image img = Image.getInstance("src/img/a.jpg");
        
        String ruc = "123456";
        String nom = "Juan";
                
        doc.close();
        archivo.close();
         JOptionPane.showMessageDialog(null, "Reporte creado");
        }catch (Exception e){
            
        }
    }
    
    public subMenuProducto() {
        initComponents();
        txtId.setVisible(false);
    }
    
    

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        txtId = new javax.swing.JTextField();
        btnBuscar = new javax.swing.JButton();
        btnEliminar = new javax.swing.JButton();
        btnLimpiar = new javax.swing.JButton();
        btnModificar = new javax.swing.JButton();
        txtProveedor = new javax.swing.JTextField();
        btnGuardar = new javax.swing.JButton();
        txtEstado = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        txtDisponibilidad = new javax.swing.JTextField();
        txtPrecio = new javax.swing.JTextField();
        jLabel4 = new javax.swing.JLabel();
        txtMarca = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        txtNombre = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        txtCodigo = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setPreferredSize(new java.awt.Dimension(950, 650));
        getContentPane().setLayout(null);

        jPanel1.setPreferredSize(new java.awt.Dimension(950, 650));
        jPanel1.setLayout(null);

        jButton1.setBackground(new java.awt.Color(255, 255, 255));
        jButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/document.png"))); // NOI18N
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        jPanel1.add(jButton1);
        jButton1.setBounds(790, 370, 50, 48);

        txtId.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtIdActionPerformed(evt);
            }
        });
        jPanel1.add(txtId);
        txtId.setBounds(310, 520, 111, 24);

        btnBuscar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/buscando.png"))); // NOI18N
        btnBuscar.setText("Buscar");
        btnBuscar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnBuscarActionPerformed(evt);
            }
        });
        jPanel1.add(btnBuscar);
        btnBuscar.setBounds(750, 80, 120, 40);

        btnEliminar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/basura.png"))); // NOI18N
        btnEliminar.setText("Eliminar");
        btnEliminar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEliminarActionPerformed(evt);
            }
        });
        jPanel1.add(btnEliminar);
        btnEliminar.setBounds(750, 230, 120, 40);

        btnLimpiar.setBackground(new java.awt.Color(255, 255, 255));
        btnLimpiar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/archeology.png"))); // NOI18N
        btnLimpiar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLimpiarActionPerformed(evt);
            }
        });
        jPanel1.add(btnLimpiar);
        btnLimpiar.setBounds(790, 310, 50, 48);

        btnModificar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/editar.png"))); // NOI18N
        btnModificar.setText("Modificar");
        btnModificar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnModificarActionPerformed(evt);
            }
        });
        jPanel1.add(btnModificar);
        btnModificar.setBounds(750, 180, 120, 40);
        jPanel1.add(txtProveedor);
        txtProveedor.setBounds(240, 460, 360, 30);

        btnGuardar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/salvar (1).png"))); // NOI18N
        btnGuardar.setText("Guardar");
        btnGuardar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGuardarActionPerformed(evt);
            }
        });
        jPanel1.add(btnGuardar);
        btnGuardar.setBounds(750, 130, 120, 40);
        jPanel1.add(txtEstado);
        txtEstado.setBounds(240, 400, 360, 30);

        jLabel7.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(255, 255, 255));
        jLabel7.setText("Proveedor:");
        jPanel1.add(jLabel7);
        jLabel7.setBounds(120, 460, 110, 30);

        jLabel6.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(255, 255, 255));
        jLabel6.setText("Estado:");
        jPanel1.add(jLabel6);
        jLabel6.setBounds(120, 400, 110, 30);

        jLabel5.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(255, 255, 255));
        jLabel5.setText("Disponibilidad:");
        jPanel1.add(jLabel5);
        jLabel5.setBounds(120, 340, 110, 30);
        jPanel1.add(txtDisponibilidad);
        txtDisponibilidad.setBounds(240, 340, 360, 30);
        jPanel1.add(txtPrecio);
        txtPrecio.setBounds(240, 280, 360, 30);

        jLabel4.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("Precio:");
        jPanel1.add(jLabel4);
        jLabel4.setBounds(120, 280, 110, 30);
        jPanel1.add(txtMarca);
        txtMarca.setBounds(240, 220, 360, 30);

        jLabel3.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 255, 255));
        jLabel3.setText("Marca:");
        jPanel1.add(jLabel3);
        jLabel3.setBounds(120, 220, 110, 30);
        jPanel1.add(txtNombre);
        txtNombre.setBounds(240, 160, 360, 30);

        jLabel2.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        jLabel2.setText("Nombre:");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(120, 160, 100, 30);
        jPanel1.add(txtCodigo);
        txtCodigo.setBounds(240, 100, 360, 30);

        jLabel1.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 255, 255));
        jLabel1.setText("<html>Codigo del producto:</html>");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(120, 100, 90, 30);

        jLabel8.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Img/Producto.png"))); // NOI18N
        jLabel8.setPreferredSize(new java.awt.Dimension(950, 650));
        jPanel1.add(jLabel8);
        jLabel8.setBounds(0, 0, 950, 630);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(0, 0, 950, 630);

        pack();
    }// </editor-fold>                        

    private void btnGuardarActionPerformed(java.awt.event.ActionEvent evt) {                                           
        Connection con = null;

        try{
            con = getConnection();
            ps = con.prepareStatement("INSERT INTO producto (codigo_producto, nombre, marca, precio, disponibles, en_venta, id_proveedor) VALUES(?,?,?,?,?,?,?)");
            ps.setString(1, txtCodigo.getText());
            ps.setString(2, txtNombre.getText());
            ps.setString(3, txtMarca.getText());
            ps.setString(4, txtPrecio.getText());
            ps.setString(5, txtDisponibilidad.getText());
            ps.setString(6, txtEstado.getText());
            ps.setString(7, txtProveedor.getText());

            int res = ps.executeUpdate();

            if(res>0){
                JOptionPane.showMessageDialog(null, "Registro guardado");
                limpiarCajas();
            }else {
                JOptionPane.showMessageDialog(null, "Error al guardar producto");
                limpiarCajas();
            }
            con.close();
        }catch(Exception e){
            System.err.println(e);
        }
    }                                          

    private void btnModificarActionPerformed(java.awt.event.ActionEvent evt) {                                             
        Connection con = null;

        try{
            con = getConnection();
            ps = con.prepareStatement("UPDATE producto SET codigo_producto=?, nombre=?, marca=?, precio=?, disponibles=?, en_venta=?, id_proveedor=? WHERE id_producto=?");
            ps.setString(1, txtCodigo.getText());
            ps.setString(2, txtNombre.getText());
            ps.setString(3, txtMarca.getText());
            ps.setString(4, txtPrecio.getText());
            ps.setString(5, txtDisponibilidad.getText());
            ps.setString(6, txtEstado.getText());
            ps.setString(7, txtProveedor.getText());
            ps.setString(8, txtId.getText());

            int res = ps.executeUpdate();

            if(res>0){
                JOptionPane.showMessageDialog(null, "Registro modificado");
                limpiarCajas();
            }else {
                JOptionPane.showMessageDialog(null, "Error al modificar producto");
                limpiarCajas();
            }
            con.close();
        }catch(Exception e){
            System.err.println(e);
        }
    }                                            

    private void btnLimpiarActionPerformed(java.awt.event.ActionEvent evt) {                                           
        limpiarCajas();
    }                                          

    private void btnEliminarActionPerformed(java.awt.event.ActionEvent evt) {                                            
        Connection con = null;

        try{
            con = getConnection();
            ps = con.prepareStatement("DELETE FROM producto WHERE id_producto=?");
            ps.setInt(1, Integer.parseInt(txtId.getText()));

            int res = ps.executeUpdate();

            if(res>0){
                JOptionPane.showMessageDialog(null, "Registro eliminado");
                limpiarCajas();
            }else {
                JOptionPane.showMessageDialog(null, "Error al eliminar producto");
                limpiarCajas();
            }
            con.close();
        }catch(Exception e){
            System.err.println(e);
        }
    }                                           

    private void btnBuscarActionPerformed(java.awt.event.ActionEvent evt) {                                          
        Connection con = null;
        
        try{
            con = getConnection();
            ps = con.prepareStatement("SELECT * FROM producto WHERE codigo_producto = ?");
            ps.setString(1, txtCodigo.getText());
            
            rs = ps.executeQuery();
            
            if(rs.next()){
                txtId.setText(rs.getString("id_producto"));
                txtCodigo.setText(rs.getString("codigo_producto"));
                txtNombre.setText(rs.getString("nombre"));
                txtMarca.setText(rs.getString("marca"));
                txtPrecio.setText(rs.getString("precio"));
                txtDisponibilidad.setText(rs.getString("disponibles"));
                txtEstado.setText(rs.getString("en_venta"));
                txtProveedor.setText(rs.getString("id_proveedor"));
                
                
            }else {
                JOptionPane.showMessageDialog(null, "No existe el producto con estos valores");
            }
            
        }catch(Exception e){
            System.err.println(e);
        } 
    }                                         

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        pdf();
    }                                        

    private void txtIdActionPerformed(java.awt.event.ActionEvent evt) {                                      
        // TODO add your handling code here:
    }                                     


    // Variables declaration - do not modify                     
    private javax.swing.JButton btnBuscar;
    private javax.swing.JButton btnEliminar;
    private javax.swing.JButton btnGuardar;
    private javax.swing.JButton btnLimpiar;
    private javax.swing.JButton btnModificar;
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JTextField txtCodigo;
    private javax.swing.JTextField txtDisponibilidad;
    private javax.swing.JTextField txtEstado;
    private javax.swing.JTextField txtId;
    private javax.swing.JTextField txtMarca;
    private javax.swing.JTextField txtNombre;
    private javax.swing.JTextField txtPrecio;
    private javax.swing.JTextField txtProveedor;
    // End of variables declaration                   
}
